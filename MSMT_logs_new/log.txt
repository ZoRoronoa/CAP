log_dir=  MSMT_logs_new
args=  Namespace(arch='resnet50', base_lr=0.00035, batch_size=32, data_dir='/data0/ReIDData/', dropout=0.5, epochs=50, evaluate=False, features=2048, height=256, inv_alpha=0.2, inv_beta=0.07, load_ckpt='', logs_dir='MSMT_logs_new', milestones=[20, 40], momentum=0.9, pool_type='avgpool', print_freq=1, re=0.5, resume='', target='MSMT17_V1', thresh=0.5, use_bnneck=True, weight_decay=0.0005, width=128, workers=8)
train image_dir= /data0/ReIDData/MSMT17_V1/bounding_box_train
  length of all_img_prefix= 32621
  32621 samples in total.
  all cameras shape= (32621,), dtype= int64, unique values= [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
train image_dir= /data0/ReIDData/MSMT17_V1/bounding_box_train
  length of all_img_prefix= 32621
  32621 samples in total.
  all cameras shape= (32621,), dtype= int64, unique values= [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
DA dataset loaded
  subset   | # ids | # images
  ---------------------------
  target train    | 'Unknown' |    32621
  query    |  3060 |    11659
  gallery  |  3060 |    82161
  target train(ori)| 'Unknown' |    32621
Epoch 0 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 479.093284368515
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1238, 9327/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1362
Epoch: [0][291/291], Time 0.133 (0.178), Data 0.000 (0.002), Loss 16.205 (18.550), memo_loss: 16.205
Epoch 1 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 364.26210021972656
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1391, 11320/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1658
Epoch: [1][353/353], Time 0.136 (0.164), Data 0.000 (0.002), Loss 1.996 (3.627), memo_loss: 1.996
Epoch 2 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 455.4690511226654
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1945, 18029/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2456
Epoch: [2][563/563], Time 0.141 (0.164), Data 0.000 (0.002), Loss 2.415 (2.813), memo_loss: 2.415
Epoch 3 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 690.3310883045197
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2199, 22050/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3042
Epoch: [3][689/689], Time 0.143 (0.160), Data 0.000 (0.001), Loss 4.606 (2.431), memo_loss: 4.606
Epoch 4 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 450.6233775615692
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2322, 24441/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3436
Epoch: [4][763/763], Time 0.192 (0.171), Data 0.000 (0.001), Loss 1.212 (2.375), memo_loss: 1.212
Epoch 5 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 802.1208527088165
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2387, 26029/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3815
Epoch: [5][813/813], Time 0.198 (0.271), Data 0.000 (0.001), Loss 7.982 (8.202), memo_loss: 7.982
Epoch 6 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 589.3824717998505
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2334, 27330/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4051
Epoch: [6][854/854], Time 0.207 (0.249), Data 0.000 (0.001), Loss 6.065 (7.595), memo_loss: 6.065
Epoch 7 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 766.5353591442108
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2320, 28031/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4279
Epoch: [7][875/875], Time 0.245 (0.306), Data 0.000 (0.001), Loss 7.712 (7.742), memo_loss: 7.712
Epoch 8 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 779.7374758720398
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2262, 28610/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4346
Epoch: [8][894/894], Time 0.385 (0.247), Data 0.000 (0.001), Loss 8.681 (7.753), memo_loss: 8.681
Epoch 9 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 665.9419279098511
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2272, 29013/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4528
Epoch: [9][906/906], Time 0.229 (0.246), Data 0.000 (0.001), Loss 5.118 (7.869), memo_loss: 5.118
Test with epoch 9 model:
    rank1: 0.4597, rank5: 0.5802, rank10: 0.6296, rank20: 0.6825, mAP: 0.1929
Epoch 10 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 312.889924287796
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2251, 28937/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4583
Epoch: [10][904/904], Time 0.323 (0.324), Data 0.000 (0.004), Loss 9.270 (8.066), memo_loss: 9.270
Epoch 11 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 89.31334710121155
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2226, 29298/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4666
Epoch: [11][915/915], Time 0.362 (0.250), Data 0.000 (0.003), Loss 6.463 (7.858), memo_loss: 6.463
Epoch 12 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 103.68069195747375
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2197, 29334/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4711
Epoch: [12][916/916], Time 0.264 (0.245), Data 0.000 (0.003), Loss 6.198 (7.688), memo_loss: 6.198
Epoch 13 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 891.1899182796478
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2187, 29706/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4844
Epoch: [13][928/928], Time 0.206 (0.271), Data 0.000 (0.002), Loss 4.855 (7.605), memo_loss: 4.855
Epoch 14 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 119.57491517066956
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2177, 29503/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4860
Epoch: [14][921/921], Time 0.225 (0.243), Data 0.000 (0.005), Loss 10.326 (7.799), memo_loss: 10.326
Epoch 15 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 144.68266892433167
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2174, 29774/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4915
Epoch: [15][930/930], Time 0.262 (0.266), Data 0.000 (0.005), Loss 9.774 (7.688), memo_loss: 9.774
Epoch 16 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 159.39019441604614
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2163, 29980/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4981
Epoch: [16][936/936], Time 0.359 (0.300), Data 0.000 (0.004), Loss 6.733 (7.448), memo_loss: 6.733
Epoch 17 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 818.6048340797424
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2182, 30062/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4997
Epoch: [17][939/939], Time 0.548 (0.341), Data 0.000 (0.003), Loss 8.084 (7.533), memo_loss: 8.084
Epoch 18 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 149.57679057121277
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2142, 30155/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5029
Epoch: [18][942/942], Time 0.266 (0.269), Data 0.000 (0.002), Loss 5.902 (7.474), memo_loss: 5.902
Epoch 19 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 75.04339861869812
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2140, 30208/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5073
Epoch: [19][944/944], Time 0.195 (0.210), Data 0.000 (0.002), Loss 8.831 (7.446), memo_loss: 8.831
Test with epoch 19 model:
    rank1: 0.5579, rank5: 0.6781, rank10: 0.7253, rank20: 0.7737, mAP: 0.2671
Epoch 20 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 52.462971448898315
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2143, 30122/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5059
Epoch: [20][941/941], Time 0.165 (0.207), Data 0.000 (0.002), Loss 4.641 (6.784), memo_loss: 4.641
Epoch 21 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.412882804870605
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2113, 30576/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5178
Epoch: [21][955/955], Time 0.277 (0.241), Data 0.000 (0.002), Loss 7.659 (6.397), memo_loss: 7.659
Epoch 22 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.38402771949768
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2101, 30802/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5246
Epoch: [22][962/962], Time 0.180 (0.215), Data 0.000 (0.002), Loss 6.930 (6.291), memo_loss: 6.930
Epoch 23 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 55.01517677307129
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2101, 30915/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5299
Epoch: [23][966/966], Time 0.188 (0.216), Data 0.000 (0.003), Loss 6.903 (6.219), memo_loss: 6.903
Epoch 24 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 59.97857332229614
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2087, 31010/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5338
Epoch: [24][969/969], Time 0.179 (0.211), Data 0.000 (0.002), Loss 5.226 (6.263), memo_loss: 5.226
Epoch 25 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 52.5234158039093
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2087, 31089/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5373
Epoch: [25][971/971], Time 0.173 (0.209), Data 0.000 (0.002), Loss 5.029 (6.111), memo_loss: 5.029
Epoch 26 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 49.342045068740845
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2093, 31136/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5396
Epoch: [26][973/973], Time 0.203 (0.211), Data 0.000 (0.002), Loss 5.743 (6.085), memo_loss: 5.743
Epoch 27 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.19066858291626
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2086, 31200/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5409
Epoch: [27][975/975], Time 0.198 (0.213), Data 0.000 (0.002), Loss 5.251 (5.996), memo_loss: 5.251
Epoch 28 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.64580011367798
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2088, 31243/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5431
Epoch: [28][976/976], Time 0.185 (0.205), Data 0.000 (0.002), Loss 5.533 (5.946), memo_loss: 5.533
Epoch 29 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.58749866485596
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2085, 31317/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5459
Epoch: [29][978/978], Time 0.204 (0.229), Data 0.000 (0.002), Loss 5.202 (5.977), memo_loss: 5.202
Test with epoch 29 model:
    rank1: 0.6577, rank5: 0.7662, rank10: 0.8066, rank20: 0.8432, mAP: 0.3421
Epoch 30 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 68.81574487686157
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2095, 31369/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5492
Epoch: [30][980/980], Time 0.175 (0.180), Data 0.000 (0.002), Loss 5.970 (5.819), memo_loss: 5.970
Epoch 31 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.45776963233948
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2085, 31364/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5502
Epoch: [31][980/980], Time 0.165 (0.181), Data 0.000 (0.002), Loss 6.898 (5.854), memo_loss: 6.898
Epoch 32 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.3998122215271
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2097, 31485/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5527
Epoch: [32][983/983], Time 0.186 (0.180), Data 0.000 (0.002), Loss 6.104 (5.700), memo_loss: 6.104
Epoch 33 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 41.891088008880615
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2094, 31554/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5552
Epoch: [33][986/986], Time 0.174 (0.181), Data 0.000 (0.002), Loss 6.778 (5.716), memo_loss: 6.778
Epoch 34 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.9674072265625
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2096, 31589/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5581
Epoch: [34][987/987], Time 0.184 (0.239), Data 0.000 (0.002), Loss 4.552 (5.795), memo_loss: 4.552
Epoch 35 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 67.24922227859497
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2092, 31628/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5597
Epoch: [35][988/988], Time 0.204 (0.184), Data 0.000 (0.002), Loss 4.250 (5.616), memo_loss: 4.250
Epoch 36 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 54.52637076377869
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2087, 31660/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5605
Epoch: [36][989/989], Time 0.164 (0.185), Data 0.000 (0.003), Loss 4.994 (5.574), memo_loss: 4.994
Epoch 37 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 62.0483341217041
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2098, 31690/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5630
Epoch: [37][990/990], Time 0.188 (0.185), Data 0.000 (0.002), Loss 5.214 (5.568), memo_loss: 5.214
Epoch 38 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.71871542930603
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2093, 31754/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5642
Epoch: [38][992/992], Time 0.168 (0.182), Data 0.000 (0.002), Loss 4.926 (5.509), memo_loss: 4.926
Epoch 39 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.007736682891846
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2086, 31811/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5655
Epoch: [39][994/994], Time 0.171 (0.177), Data 0.000 (0.002), Loss 5.669 (5.472), memo_loss: 5.669
Test with epoch 39 model:
    rank1: 0.6448, rank5: 0.7563, rank10: 0.7966, rank20: 0.8326, mAP: 0.3251
Epoch 40 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.12875175476074
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2090, 31828/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5668
Epoch: [40][994/994], Time 0.192 (0.179), Data 0.000 (0.002), Loss 6.384 (5.334), memo_loss: 6.384
Epoch 41 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.20797276496887
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2095, 31852/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5679
Epoch: [41][995/995], Time 0.182 (0.181), Data 0.000 (0.002), Loss 7.450 (5.293), memo_loss: 7.450
Epoch 42 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.56623411178589
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2091, 31857/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5683
Epoch: [42][995/995], Time 0.170 (0.178), Data 0.000 (0.002), Loss 6.302 (5.235), memo_loss: 6.302
Epoch 43 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 41.04075360298157
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2093, 31874/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5683
Epoch: [43][996/996], Time 0.179 (0.179), Data 0.000 (0.002), Loss 5.309 (5.329), memo_loss: 5.309
Epoch 44 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.63223433494568
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2093, 31876/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5690
Epoch: [44][996/996], Time 0.168 (0.181), Data 0.000 (0.002), Loss 4.953 (5.332), memo_loss: 4.953
Epoch 45 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.57988500595093
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2098, 31886/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5694
Epoch: [45][996/996], Time 0.171 (0.179), Data 0.000 (0.002), Loss 4.838 (5.230), memo_loss: 4.838
Epoch 46 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.32153105735779
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2096, 31893/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5694
Epoch: [46][996/996], Time 0.165 (0.178), Data 0.000 (0.002), Loss 4.456 (5.233), memo_loss: 4.456
Epoch 47 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.60781979560852
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2099, 31903/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5700
Epoch: [47][996/996], Time 0.172 (0.178), Data 0.000 (0.002), Loss 3.964 (5.223), memo_loss: 3.964
Epoch 48 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 41.097174882888794
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2096, 31921/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5699
Epoch: [48][997/997], Time 0.171 (0.179), Data 0.000 (0.002), Loss 4.875 (5.193), memo_loss: 4.875
Epoch 49 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.31759285926819
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2104, 31920/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 5709
Epoch: [49][997/997], Time 0.165 (0.182), Data 0.000 (0.002), Loss 4.093 (5.198), memo_loss: 4.093
Test with epoch 49 model:
    rank1: 0.6404, rank5: 0.7519, rank10: 0.7948, rank20: 0.8315, mAP: 0.3179
Final Model saved.
