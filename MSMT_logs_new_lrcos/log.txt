log_dir=  MSMT_logs_new_lrcos
args=  Namespace(arch='resnet50', base_lr=0.00035, batch_size=32, data_dir='/data0/ReIDData/', dropout=0.5, epochs=50, evaluate=False, features=2048, height=256, inv_alpha=0.2, inv_beta=0.07, load_ckpt='', logs_dir='MSMT_logs_new_lrcos', milestones=[20, 40], momentum=0.9, pool_type='avgpool', print_freq=1, re=0.5, resume='', target='MSMT17_V1', thresh=0.5, use_bnneck=True, weight_decay=0.0005, width=128, workers=8)
train image_dir= /data0/ReIDData/MSMT17_V1/bounding_box_train
  length of all_img_prefix= 32621
  32621 samples in total.
  all cameras shape= (32621,), dtype= int64, unique values= [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
train image_dir= /data0/ReIDData/MSMT17_V1/bounding_box_train
  length of all_img_prefix= 32621
  32621 samples in total.
  all cameras shape= (32621,), dtype= int64, unique values= [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
DA dataset loaded
  subset   | # ids | # images
  ---------------------------
  target train    | 'Unknown' |    32621
  query    |  3060 |    11659
  gallery  |  3060 |    82161
  target train(ori)| 'Unknown' |    32621
Epoch 0 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 51.13139033317566
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1238, 9327/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1362
Epoch: [0][291/291], Time 0.118 (0.134), Data 0.000 (0.002), Loss 22.209 (16.373), memo_loss: 22.209
Epoch 1 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.03446388244629
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1811, 17453/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2400
Epoch: [1][545/545], Time 0.126 (0.132), Data 0.000 (0.001), Loss 7.424 (8.420), memo_loss: 7.424
Epoch 2 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 50.43588995933533
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2009, 18980/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2772
Epoch: [2][593/593], Time 0.118 (0.133), Data 0.000 (0.001), Loss 4.346 (4.115), memo_loss: 4.346
Epoch 3 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.563698053359985
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2141, 20445/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3055
Epoch: [3][638/638], Time 0.116 (0.130), Data 0.000 (0.001), Loss 3.846 (4.047), memo_loss: 3.846
Epoch 4 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.82322907447815
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2179, 21189/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3205
Epoch: [4][662/662], Time 0.123 (0.131), Data 0.000 (0.001), Loss 4.265 (3.882), memo_loss: 4.265
Epoch 5 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.46321630477905
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2271, 21989/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3262
Epoch: [5][687/687], Time 0.170 (0.188), Data 0.000 (0.001), Loss 9.530 (10.626), memo_loss: 9.530
Epoch 6 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.6509804725647
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2298, 22159/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3253
Epoch: [6][692/692], Time 0.193 (0.185), Data 0.000 (0.001), Loss 8.316 (9.785), memo_loss: 8.316
Epoch 7 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 45.81945753097534
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2331, 22466/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3278
Epoch: [7][702/702], Time 0.166 (0.188), Data 0.000 (0.001), Loss 9.179 (9.136), memo_loss: 9.179
Epoch 8 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 49.25358200073242
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2314, 23159/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3382
Epoch: [8][723/723], Time 0.193 (0.188), Data 0.000 (0.001), Loss 7.859 (9.038), memo_loss: 7.859
Epoch 9 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.3998761177063
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2341, 24033/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3463
Epoch: [9][751/751], Time 0.183 (0.187), Data 0.000 (0.001), Loss 7.670 (8.524), memo_loss: 7.670
Test with epoch 9 model:
    rank1: 0.1709, rank5: 0.2639, rank10: 0.3133, rank20: 0.3644, mAP: 0.0585
Epoch 10 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.84141755104065
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2295, 22674/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3278
Epoch: [10][708/708], Time 0.224 (0.189), Data 0.000 (0.001), Loss 9.037 (9.994), memo_loss: 9.037
Epoch 11 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.99185061454773
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2332, 24282/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3492
Epoch: [11][758/758], Time 0.175 (0.186), Data 0.000 (0.001), Loss 7.503 (8.791), memo_loss: 7.503
Epoch 12 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.051762342453
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2366, 24789/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3629
Epoch: [12][774/774], Time 0.191 (0.185), Data 0.000 (0.001), Loss 12.120 (8.527), memo_loss: 12.120
Epoch 13 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 51.412413358688354
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2347, 24740/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3685
Epoch: [13][773/773], Time 0.184 (0.184), Data 0.000 (0.001), Loss 5.140 (9.361), memo_loss: 5.140
Epoch 14 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 48.07817196846008
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2385, 25408/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3775
Epoch: [14][794/794], Time 0.169 (0.187), Data 0.000 (0.001), Loss 8.375 (8.516), memo_loss: 8.375
Epoch 15 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.10063123703003
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2401, 25934/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3876
Epoch: [15][810/810], Time 0.183 (0.188), Data 0.000 (0.001), Loss 6.922 (7.966), memo_loss: 6.922
Epoch 16 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.11693000793457
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2371, 25113/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3735
Epoch: [16][784/784], Time 0.176 (0.186), Data 0.000 (0.001), Loss 8.425 (8.684), memo_loss: 8.425
Epoch 17 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 45.11130475997925
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2381, 25876/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3835
Epoch: [17][808/808], Time 0.204 (0.193), Data 0.000 (0.001), Loss 6.633 (8.630), memo_loss: 6.633
Epoch 18 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.41437482833862
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2423, 25982/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3896
Epoch: [18][811/811], Time 0.168 (0.184), Data 0.000 (0.001), Loss 8.844 (8.012), memo_loss: 8.844
Epoch 19 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.478530406951904
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2380, 25892/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3916
Epoch: [19][809/809], Time 0.179 (0.187), Data 0.000 (0.001), Loss 10.284 (8.230), memo_loss: 10.284
Test with epoch 19 model:
    rank1: 0.2993, rank5: 0.4138, rank10: 0.4679, rank20: 0.5249, mAP: 0.1133
Epoch 20 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.49708962440491
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2377, 26074/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3982
Epoch: [20][814/814], Time 0.191 (0.186), Data 0.000 (0.001), Loss 11.304 (8.362), memo_loss: 11.304
Epoch 21 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.239089488983154
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2364, 26114/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3993
Epoch: [21][816/816], Time 0.176 (0.177), Data 0.000 (0.001), Loss 7.168 (8.317), memo_loss: 7.168
Epoch 22 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 41.15219521522522
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2339, 26176/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4057
Epoch: [22][818/818], Time 0.176 (0.179), Data 0.000 (0.001), Loss 8.217 (8.945), memo_loss: 8.217
Epoch 23 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.19773626327515
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2319, 26106/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4009
Epoch: [23][815/815], Time 0.166 (0.176), Data 0.000 (0.001), Loss 6.004 (8.414), memo_loss: 6.004
Epoch 24 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 64.49905681610107
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2337, 25868/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3980
Epoch: [24][808/808], Time 0.165 (0.180), Data 0.000 (0.001), Loss 5.337 (8.700), memo_loss: 5.337
Epoch 25 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 53.73612880706787
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2343, 25920/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3915
Epoch: [25][810/810], Time 0.173 (0.182), Data 0.000 (0.001), Loss 11.470 (13.109), memo_loss: 11.470
Epoch 26 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 38.493136405944824
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2397, 26269/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4003
Epoch: [26][820/820], Time 0.169 (0.177), Data 0.000 (0.001), Loss 13.584 (13.517), memo_loss: 13.584
Epoch 27 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.91641855239868
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2347, 26268/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3989
Epoch: [27][820/820], Time 0.164 (0.176), Data 0.000 (0.001), Loss 12.611 (11.718), memo_loss: 12.611
Epoch 28 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 39.6391966342926
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2371, 26390/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4036
Epoch: [28][824/824], Time 0.163 (0.176), Data 0.000 (0.001), Loss 7.265 (12.295), memo_loss: 7.265
Epoch 29 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.91745114326477
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2355, 26468/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4074
Epoch: [29][827/827], Time 0.167 (0.176), Data 0.000 (0.001), Loss 13.012 (9.850), memo_loss: 13.012
Test with epoch 29 model:
    rank1: 0.3068, rank5: 0.4202, rank10: 0.4717, rank20: 0.5271, mAP: 0.1128
Epoch 30 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 38.48685550689697
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2386, 26285/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4085
Epoch: [30][821/821], Time 0.163 (0.166), Data 0.000 (0.001), Loss 7.401 (9.533), memo_loss: 7.401
Epoch 31 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 38.3544385433197
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2396, 26380/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4072
Epoch: [31][824/824], Time 0.200 (0.180), Data 0.000 (0.001), Loss 10.766 (9.642), memo_loss: 10.766
Epoch 32 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.61742401123047
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2384, 26528/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4109
Epoch: [32][829/829], Time 0.189 (0.192), Data 0.000 (0.001), Loss 14.153 (10.572), memo_loss: 14.153
Epoch 33 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.02050232887268
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2396, 26625/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4088
Epoch: [33][832/832], Time 0.206 (0.193), Data 0.000 (0.001), Loss 14.369 (9.208), memo_loss: 14.369
Epoch 34 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 45.75388550758362
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2371, 26653/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4134
Epoch: [34][832/832], Time 0.199 (0.190), Data 0.000 (0.001), Loss 5.973 (8.245), memo_loss: 5.973
Epoch 35 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.3207061290741
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2363, 26436/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4074
Epoch: [35][826/826], Time 0.184 (0.193), Data 0.000 (0.001), Loss 8.137 (8.202), memo_loss: 8.137
Epoch 36 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.71746897697449
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2373, 25891/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4037
Epoch: [36][809/809], Time 0.179 (0.194), Data 0.000 (0.001), Loss 7.811 (8.291), memo_loss: 7.811
Epoch 37 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.827171087265015
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2335, 26330/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4093
Epoch: [37][822/822], Time 0.168 (0.190), Data 0.000 (0.001), Loss 6.656 (8.267), memo_loss: 6.656
Epoch 38 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.21019625663757
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2360, 26495/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4106
Epoch: [38][827/827], Time 0.204 (0.192), Data 0.000 (0.001), Loss 10.375 (9.339), memo_loss: 10.375
Epoch 39 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.75182271003723
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2385, 26771/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4201
Epoch: [39][836/836], Time 0.176 (0.194), Data 0.000 (0.001), Loss 6.585 (9.109), memo_loss: 6.585
Test with epoch 39 model:
    rank1: 0.3386, rank5: 0.4551, rank10: 0.5071, rank20: 0.5631, mAP: 0.1254
Epoch 40 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.06187844276428
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2343, 26739/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4154
Epoch: [40][835/835], Time 0.198 (0.194), Data 0.000 (0.001), Loss 11.997 (9.220), memo_loss: 11.997
Epoch 41 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 45.64265584945679
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2354, 26987/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4199
Epoch: [41][843/843], Time 0.178 (0.194), Data 0.000 (0.001), Loss 5.116 (8.245), memo_loss: 5.116
Epoch 42 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 45.73724055290222
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2392, 26709/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4197
Epoch: [42][834/834], Time 0.179 (0.193), Data 0.000 (0.001), Loss 6.986 (8.341), memo_loss: 6.986
Epoch 43 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 49.86657643318176
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2380, 26885/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4196
Epoch: [43][840/840], Time 0.213 (0.195), Data 0.000 (0.001), Loss 9.209 (8.666), memo_loss: 9.209
Epoch 44 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.09134268760681
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2363, 26718/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4139
Epoch: [44][834/834], Time 0.176 (0.193), Data 0.000 (0.001), Loss 8.045 (7.720), memo_loss: 8.045
Epoch 45 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 46.27683186531067
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2344, 26967/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4267
Epoch: [45][842/842], Time 0.188 (0.193), Data 0.000 (0.001), Loss 11.121 (8.085), memo_loss: 11.121
Epoch 46 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.20962834358215
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2363, 26945/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4225
Epoch: [46][842/842], Time 0.197 (0.197), Data 0.000 (0.001), Loss 8.364 (9.769), memo_loss: 8.364
Epoch 47 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.162498474121094
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2387, 27303/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4282
Epoch: [47][853/853], Time 0.173 (0.193), Data 0.000 (0.001), Loss 8.531 (8.031), memo_loss: 8.531
Epoch 48 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 48.20428705215454
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2395, 27376/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4318
Epoch: [48][855/855], Time 0.212 (0.195), Data 0.000 (0.001), Loss 5.725 (8.560), memo_loss: 5.725
Epoch 49 image grouping:
Start Inference...
  features: shape= (32621, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.08900284767151
  distance matrix: shape= (32621, 32621)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 2405, 26103/32621 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 4096
Epoch: [49][815/815], Time 0.188 (0.193), Data 0.000 (0.001), Loss 7.785 (9.265), memo_loss: 7.785
Test with epoch 49 model:
    rank1: 0.3490, rank5: 0.4622, rank10: 0.5148, rank20: 0.5725, mAP: 0.1328
Final Model saved.
