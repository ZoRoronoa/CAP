log_dir=  Duke_logs_new
args=  Namespace(arch='resnet50', base_lr=0.00035, batch_size=32, data_dir='/data0/ReIDData/', dropout=0.5, epochs=50, evaluate=False, features=2048, height=256, inv_alpha=0.2, inv_beta=0.07, load_ckpt='', logs_dir='Duke_logs_new', milestones=[20, 40], momentum=0.9, pool_type='avgpool', print_freq=1, re=0.5, resume='', target='dukemtmcreid', thresh=0.5, use_bnneck=True, weight_decay=0.0005, width=128, workers=8)
train image_dir= /data0/ReIDData/dukemtmcreid/bounding_box_train
  length of all_img_prefix= 16522
  16522 samples in total.
  all cameras shape= (16522,), dtype= int64, unique values= [0 1 2 3 4 5 6 7]
train image_dir= /data0/ReIDData/dukemtmcreid/bounding_box_train
  length of all_img_prefix= 16522
  16522 samples in total.
  all cameras shape= (16522,), dtype= int64, unique values= [0 1 2 3 4 5 6 7]
DA dataset loaded
  subset   | # ids | # images
  ---------------------------
  target train    | 'Unknown' |    16522
  query    |   702 |     2228
  gallery  |  1110 |    17661
  target train(ori)| 'Unknown' |    16522
Epoch 0 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 52.16657519340515
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 500, 5258/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 591
Epoch: [0][164/164], Time 0.139 (0.158), Data 0.000 (0.004), Loss 14.272 (15.186), memo_loss: 14.272
Epoch 1 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 302.51349449157715
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 460, 5014/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 571
Epoch: [1][156/156], Time 0.177 (0.191), Data 0.000 (0.004), Loss 1.323 (3.268), memo_loss: 1.323
Epoch 2 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 60.44996213912964
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 713, 7852/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 972
Epoch: [2][245/245], Time 0.169 (0.160), Data 0.000 (0.003), Loss 0.955 (2.533), memo_loss: 0.955
Epoch 3 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 197.8963553905487
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 886, 9972/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1324
Epoch: [3][311/311], Time 0.159 (0.164), Data 0.000 (0.002), Loss 2.791 (2.337), memo_loss: 2.791
Epoch 4 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 68.09903025627136
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 975, 11536/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1647
Epoch: [4][360/360], Time 0.198 (0.168), Data 0.000 (0.002), Loss 1.864 (2.282), memo_loss: 1.864
Epoch 5 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 313.5219051837921
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1051, 12919/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1938
Epoch: [5][403/403], Time 0.240 (0.326), Data 0.000 (0.002), Loss 4.737 (7.889), memo_loss: 4.737
Epoch 6 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 65.3243408203125
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1041, 13726/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2162
Epoch: [6][428/428], Time 0.204 (0.250), Data 0.000 (0.001), Loss 6.389 (7.094), memo_loss: 6.389
Epoch 7 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 619.9217808246613
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1020, 14409/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2288
Epoch: [7][450/450], Time 0.251 (0.244), Data 0.000 (0.001), Loss 7.183 (6.811), memo_loss: 7.183
Epoch 8 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 70.89981865882874
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1016, 14947/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2347
Epoch: [8][467/467], Time 0.391 (0.295), Data 0.000 (0.002), Loss 7.798 (6.935), memo_loss: 7.798
Epoch 9 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 985.4847002029419
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1009, 15176/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2384
Epoch: [9][474/474], Time 0.217 (0.251), Data 0.000 (0.001), Loss 6.010 (6.711), memo_loss: 6.010
Test with epoch 9 model:
    rank1: 0.6683, rank5: 0.7828, rank10: 0.8178, rank20: 0.8474, mAP: 0.4687
Epoch 10 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 76.48195600509644
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 981, 15282/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2358
Epoch: [10][477/477], Time 0.349 (0.331), Data 0.000 (0.002), Loss 7.393 (6.659), memo_loss: 7.393
Epoch 11 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 427.93608140945435
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 981, 15387/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2378
Epoch: [11][480/480], Time 0.492 (0.436), Data 0.000 (0.003), Loss 4.981 (6.205), memo_loss: 4.981
Epoch 12 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 74.46805739402771
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 990, 15470/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2390
Epoch: [12][483/483], Time 0.221 (0.252), Data 0.000 (0.001), Loss 4.409 (6.215), memo_loss: 4.409
Epoch 13 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.20035743713379
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 980, 15591/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2416
Epoch: [13][487/487], Time 0.192 (0.235), Data 0.000 (0.001), Loss 4.423 (6.149), memo_loss: 4.423
Epoch 14 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 488.46853017807007
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 965, 15626/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2405
Epoch: [14][488/488], Time 0.214 (0.268), Data 0.000 (0.002), Loss 6.870 (5.985), memo_loss: 6.870
Epoch 15 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 68.07991099357605
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 960, 15688/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2401
Epoch: [15][490/490], Time 0.213 (0.246), Data 0.000 (0.001), Loss 5.192 (5.863), memo_loss: 5.192
Epoch 16 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 691.2011890411377
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 964, 15813/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2426
Epoch: [16][494/494], Time 0.416 (0.348), Data 0.000 (0.001), Loss 8.079 (5.677), memo_loss: 8.079
Epoch 17 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 506.24182295799255
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 968, 15742/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2437
Epoch: [17][491/491], Time 0.262 (0.250), Data 0.000 (0.002), Loss 3.862 (5.671), memo_loss: 3.862
Epoch 18 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 78.69341826438904
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 963, 15821/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2440
Epoch: [18][494/494], Time 0.240 (0.262), Data 0.000 (0.001), Loss 5.082 (5.616), memo_loss: 5.082
Epoch 19 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 425.25302934646606
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 968, 15891/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2460
Epoch: [19][496/496], Time 0.353 (0.214), Data 0.000 (0.001), Loss 5.514 (5.641), memo_loss: 5.514
Test with epoch 19 model:
    rank1: 0.7294, rank5: 0.8335, rank10: 0.8658, rank20: 0.8918, mAP: 0.5543
Epoch 20 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.60023331642151
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 15926/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2482
Epoch: [20][497/497], Time 0.226 (0.254), Data 0.000 (0.001), Loss 5.128 (4.978), memo_loss: 5.128
Epoch 21 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 296.70356249809265
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 16045/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2483
Epoch: [21][501/501], Time 0.355 (0.346), Data 0.000 (0.002), Loss 4.943 (4.596), memo_loss: 4.943
Epoch 22 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 21.54046654701233
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 978, 16056/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2489
Epoch: [22][501/501], Time 0.303 (0.247), Data 0.000 (0.002), Loss 2.866 (4.497), memo_loss: 2.866
Epoch 23 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 67.28778195381165
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16076/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2491
Epoch: [23][502/502], Time 0.238 (0.260), Data 0.000 (0.002), Loss 5.358 (4.380), memo_loss: 5.358
Epoch 24 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 42.03494668006897
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 969, 16106/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2500
Epoch: [24][503/503], Time 0.302 (0.257), Data 0.000 (0.001), Loss 3.127 (4.383), memo_loss: 3.127
Epoch 25 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.277588844299316
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 973, 16144/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2507
Epoch: [25][504/504], Time 0.199 (0.249), Data 0.000 (0.001), Loss 3.815 (4.204), memo_loss: 3.815
Epoch 26 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 60.14595699310303
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 962, 16158/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2499
Epoch: [26][504/504], Time 0.186 (0.249), Data 0.000 (0.001), Loss 4.666 (4.142), memo_loss: 4.666
Epoch 27 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 52.92001676559448
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 966, 16197/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2510
Epoch: [27][506/506], Time 0.223 (0.248), Data 0.000 (0.001), Loss 5.771 (4.137), memo_loss: 5.771
Epoch 28 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 55.897408962249756
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 967, 16192/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2516
Epoch: [28][506/506], Time 0.415 (0.306), Data 0.000 (0.001), Loss 5.394 (4.065), memo_loss: 5.394
Epoch 29 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 768.2503800392151
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16213/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2521
Epoch: [29][506/506], Time 0.518 (0.257), Data 0.000 (0.001), Loss 2.931 (4.012), memo_loss: 2.931
Test with epoch 29 model:
    rank1: 0.7760, rank5: 0.8698, rank10: 0.8900, rank20: 0.9071, mAP: 0.6157
Epoch 30 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 1992.2941162586212
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 975, 16203/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2530
Epoch: [30][506/506], Time 0.246 (0.237), Data 0.000 (0.001), Loss 4.032 (3.960), memo_loss: 4.032
Epoch 31 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.442000150680542
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 973, 16237/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2532
Epoch: [31][507/507], Time 0.203 (0.209), Data 0.000 (0.001), Loss 3.126 (3.880), memo_loss: 3.126
Epoch 32 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.785349130630493
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16259/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2533
Epoch: [32][508/508], Time 0.220 (0.246), Data 0.000 (0.001), Loss 2.514 (3.897), memo_loss: 2.514
Epoch 33 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 1153.9426820278168
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16262/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2538
Epoch: [33][508/508], Time 0.314 (0.239), Data 0.000 (0.002), Loss 3.111 (3.807), memo_loss: 3.111
Epoch 34 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 78.31756281852722
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16285/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2540
Epoch: [34][508/508], Time 0.228 (0.243), Data 0.000 (0.002), Loss 3.886 (3.835), memo_loss: 3.886
Epoch 35 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 774.7750024795532
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 16311/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2539
Epoch: [35][509/509], Time 0.225 (0.315), Data 0.000 (0.003), Loss 5.061 (3.820), memo_loss: 5.061
Epoch 36 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 1085.4999256134033
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 968, 16302/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2538
Epoch: [36][509/509], Time 0.229 (0.235), Data 0.000 (0.002), Loss 4.727 (3.770), memo_loss: 4.727
Epoch 37 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 71.78185606002808
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 975, 16315/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2545
Epoch: [37][509/509], Time 0.248 (0.237), Data 0.000 (0.002), Loss 2.871 (3.697), memo_loss: 2.871
Epoch 38 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 290.56901121139526
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 16329/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2543
Epoch: [38][510/510], Time 0.285 (0.409), Data 0.000 (0.001), Loss 3.274 (3.777), memo_loss: 3.274
Epoch 39 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 849.0605549812317
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16308/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2545
Epoch: [39][509/509], Time 0.217 (0.233), Data 0.000 (0.002), Loss 3.422 (3.713), memo_loss: 3.422
Test with epoch 39 model:
    rank1: 0.7720, rank5: 0.8689, rank10: 0.8932, rank20: 0.9134, mAP: 0.6035
Epoch 40 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 70.06786274909973
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 973, 16306/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2550
Epoch: [40][509/509], Time 0.298 (0.227), Data 0.000 (0.001), Loss 3.253 (3.604), memo_loss: 3.253
Epoch 41 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 29.071943044662476
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 971, 16312/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2549
Epoch: [41][509/509], Time 0.296 (0.361), Data 0.000 (0.002), Loss 2.835 (3.619), memo_loss: 2.835
Epoch 42 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 183.60831427574158
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16309/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2548
Epoch: [42][509/509], Time 0.233 (0.262), Data 0.000 (0.002), Loss 2.800 (3.533), memo_loss: 2.800
Epoch 43 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 48.17113637924194
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16320/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2550
Epoch: [43][510/510], Time 0.211 (0.252), Data 0.000 (0.002), Loss 3.986 (3.608), memo_loss: 3.986
Epoch 44 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 121.55030155181885
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 968, 16327/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2548
Epoch: [44][510/510], Time 0.785 (0.349), Data 0.000 (0.002), Loss 3.891 (3.633), memo_loss: 3.891
Epoch 45 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 221.19626379013062
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 969, 16337/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2549
Epoch: [45][510/510], Time 0.202 (0.263), Data 0.000 (0.002), Loss 4.560 (3.568), memo_loss: 4.560
Epoch 46 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.10813879966736
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 969, 16334/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2549
Epoch: [46][510/510], Time 0.219 (0.251), Data 0.000 (0.002), Loss 3.275 (3.574), memo_loss: 3.275
Epoch 47 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 83.91242504119873
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 968, 16328/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2547
Epoch: [47][510/510], Time 0.192 (0.242), Data 0.000 (0.002), Loss 4.140 (3.603), memo_loss: 4.140
Epoch 48 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 51.41196870803833
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 969, 16344/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2548
Epoch: [48][510/510], Time 0.192 (0.267), Data 0.000 (0.002), Loss 2.787 (3.541), memo_loss: 2.787
Epoch 49 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 47.51228666305542
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 16334/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2551
Epoch: [49][510/510], Time 0.497 (0.320), Data 0.000 (0.002), Loss 2.678 (3.536), memo_loss: 2.678
Test with epoch 49 model:
    rank1: 0.7751, rank5: 0.8698, rank10: 0.8950, rank20: 0.9156, mAP: 0.6012
Final Model saved.
