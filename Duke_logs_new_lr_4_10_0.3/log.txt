log_dir=  Duke_logs_new_lr_4_10_0.3
args=  Namespace(arch='resnet50', base_lr=0.00035, batch_size=32, data_dir='/data0/ReIDData/', dropout=0.5, epochs=50, evaluate=False, features=2048, height=256, inv_alpha=0.2, inv_beta=0.07, load_ckpt='', logs_dir='Duke_logs_new_lr_4_10_0.3', milestones=[10, 20, 30, 40], momentum=0.9, pool_type='avgpool', print_freq=1, re=0.5, resume='', target='dukemtmcreid', thresh=0.5, use_bnneck=True, weight_decay=0.0005, width=128, workers=8)
train image_dir= /data0/ReIDData/dukemtmcreid/bounding_box_train
  length of all_img_prefix= 16522
  16522 samples in total.
  all cameras shape= (16522,), dtype= int64, unique values= [0 1 2 3 4 5 6 7]
train image_dir= /data0/ReIDData/dukemtmcreid/bounding_box_train
  length of all_img_prefix= 16522
  16522 samples in total.
  all cameras shape= (16522,), dtype= int64, unique values= [0 1 2 3 4 5 6 7]
DA dataset loaded
  subset   | # ids | # images
  ---------------------------
  target train    | 'Unknown' |    16522
  query    |   702 |     2228
  gallery  |  1110 |    17661
  target train(ori)| 'Unknown' |    16522
learing rate be like [3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06] 160
learing rate be like [3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06, 3.5e-06] 160
Epoch 0 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 40.325952768325806
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 500, 5258/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 591
Epoch: [0][164/164], Time 0.127 (0.164), Data 0.000 (0.003), Loss 14.540 (14.991), memo_loss: 14.540
learing rate be like [9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05, 9.0125e-05] 160
Epoch 1 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 37.02311038970947
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 473, 5053/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 586
Epoch: [1][157/157], Time 0.136 (0.160), Data 0.000 (0.003), Loss 2.765 (3.296), memo_loss: 2.765
learing rate be like [0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675, 0.00017675] 160
Epoch 2 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 62.215765953063965
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 782, 8950/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1114
Epoch: [2][279/279], Time 1.212 (0.139), Data 0.000 (0.003), Loss 5.022 (3.202), memo_loss: 5.022
Test with epoch 2 model:
    rank1: 0.2401, rank5: 0.3573, rank10: 0.4165, rank20: 0.4785, mAP: 0.1216
learing rate be like [0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375, 0.000263375] 160
Epoch 3 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 48.16991472244263
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 940, 11009/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1517
Epoch: [3][344/344], Time 0.129 (0.140), Data 0.000 (0.002), Loss 2.345 (2.841), memo_loss: 2.345
learing rate be like [0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035] 160
Epoch 4 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 63.0895631313324
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1022, 12107/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1865
Epoch: [4][378/378], Time 0.133 (0.140), Data 0.000 (0.001), Loss 2.444 (2.530), memo_loss: 2.444
learing rate be like [0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035] 160
Epoch 5 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 82.18453931808472
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1073, 12994/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2083
Epoch: [5][406/406], Time 0.224 (0.219), Data 0.000 (0.002), Loss 8.817 (8.080), memo_loss: 8.817
Test with epoch 5 model:
    rank1: 0.5301, rank5: 0.6625, rank10: 0.7150, rank20: 0.7572, mAP: 0.3250
learing rate be like [0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035] 160
Epoch 6 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 23.983869075775146
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1046, 13946/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2196
Epoch: [6][435/435], Time 0.205 (0.221), Data 0.000 (0.002), Loss 3.684 (6.826), memo_loss: 3.684
learing rate be like [0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035] 160
Epoch 7 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 77.96536135673523
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1028, 14713/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2302
Epoch: [7][459/459], Time 0.210 (0.199), Data 0.000 (0.002), Loss 6.831 (6.619), memo_loss: 6.831
learing rate be like [0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035] 160
Epoch 8 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 59.72985482215881
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1019, 15052/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2341
Epoch: [8][470/470], Time 0.220 (0.212), Data 0.000 (0.002), Loss 5.498 (6.281), memo_loss: 5.498
Test with epoch 8 model:
    rank1: 0.6562, rank5: 0.7680, rank10: 0.8092, rank20: 0.8425, mAP: 0.4497
learing rate be like [0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035, 0.00035] 160
Epoch 9 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 85.97943925857544
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1002, 15317/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2364
Epoch: [9][478/478], Time 0.195 (0.216), Data 0.000 (0.002), Loss 6.176 (6.484), memo_loss: 6.176
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 10 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 76.2989411354065
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 992, 15438/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2394
Epoch: [10][482/482], Time 0.186 (0.207), Data 0.000 (0.001), Loss 4.480 (5.537), memo_loss: 4.480
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 11 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 73.2433602809906
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 981, 15715/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2407
Epoch: [11][491/491], Time 0.187 (0.229), Data 0.000 (0.001), Loss 5.280 (5.169), memo_loss: 5.280
Test with epoch 11 model:
    rank1: 0.7428, rank5: 0.8317, rank10: 0.8586, rank20: 0.8802, mAP: 0.5581
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 12 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 77.71391558647156
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 981, 15770/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2435
Epoch: [12][492/492], Time 0.243 (0.223), Data 0.000 (0.002), Loss 5.828 (5.239), memo_loss: 5.828
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 13 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 79.66075944900513
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 971, 15896/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2440
Epoch: [13][496/496], Time 0.452 (0.214), Data 0.000 (0.001), Loss 5.495 (5.193), memo_loss: 5.495
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 14 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 64.5315887928009
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 15883/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2451
Epoch: [14][496/496], Time 0.217 (0.222), Data 0.000 (0.002), Loss 5.538 (4.997), memo_loss: 5.538
Test with epoch 14 model:
    rank1: 0.7558, rank5: 0.8429, rank10: 0.8739, rank20: 0.8941, mAP: 0.5780
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 15 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 86.27327609062195
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 966, 15926/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2461
Epoch: [15][497/497], Time 0.268 (0.213), Data 0.000 (0.002), Loss 3.781 (4.974), memo_loss: 3.781
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 16 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 72.38532590866089
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 967, 15972/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2476
Epoch: [16][499/499], Time 0.189 (0.212), Data 0.000 (0.001), Loss 5.866 (4.942), memo_loss: 5.866
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 17 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 82.43706107139587
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 967, 16022/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2482
Epoch: [17][500/500], Time 0.406 (0.211), Data 0.000 (0.002), Loss 4.458 (4.781), memo_loss: 4.458
Test with epoch 17 model:
    rank1: 0.7415, rank5: 0.8393, rank10: 0.8694, rank20: 0.8963, mAP: 0.5626
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 18 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 67.79142451286316
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 973, 15992/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2498
Epoch: [18][499/499], Time 0.198 (0.209), Data 0.000 (0.001), Loss 4.436 (4.875), memo_loss: 4.436
learing rate be like [0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001, 0.00014000000000000001] 160
Epoch 19 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 85.0288360118866
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 969, 16066/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2498
Epoch: [19][502/502], Time 0.190 (0.217), Data 0.000 (0.002), Loss 4.733 (4.640), memo_loss: 4.733
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 20 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 74.40554714202881
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 967, 16100/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2506
Epoch: [20][503/503], Time 0.196 (0.210), Data 0.000 (0.001), Loss 4.021 (4.331), memo_loss: 4.021
Test with epoch 20 model:
    rank1: 0.7738, rank5: 0.8559, rank10: 0.8878, rank20: 0.9062, mAP: 0.6052
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 21 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 69.79446363449097
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16163/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2520
Epoch: [21][505/505], Time 0.389 (0.204), Data 0.000 (0.001), Loss 3.275 (4.170), memo_loss: 3.275
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 22 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 75.04671883583069
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 16192/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2523
Epoch: [22][506/506], Time 0.203 (0.200), Data 0.000 (0.002), Loss 4.119 (4.046), memo_loss: 4.119
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 23 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 78.532705783844
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 979, 16224/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2538
Epoch: [23][507/507], Time 0.182 (0.215), Data 0.000 (0.001), Loss 4.494 (4.039), memo_loss: 4.494
Test with epoch 23 model:
    rank1: 0.7648, rank5: 0.8555, rank10: 0.8833, rank20: 0.8995, mAP: 0.5968
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 24 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 80.44474482536316
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 977, 16239/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2543
Epoch: [24][507/507], Time 0.192 (0.199), Data 0.000 (0.002), Loss 4.844 (3.980), memo_loss: 4.844
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 25 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 65.3507342338562
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 977, 16273/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2553
Epoch: [25][508/508], Time 0.154 (0.205), Data 0.000 (0.002), Loss 3.515 (4.014), memo_loss: 3.515
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 26 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.836572885513306
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 975, 16257/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2552
Epoch: [26][508/508], Time 0.182 (0.179), Data 0.000 (0.001), Loss 4.775 (3.917), memo_loss: 4.775
Test with epoch 26 model:
    rank1: 0.7621, rank5: 0.8550, rank10: 0.8829, rank20: 0.9008, mAP: 0.5827
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 27 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.212197065353394
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 978, 16290/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2559
Epoch: [27][509/509], Time 0.160 (0.172), Data 0.000 (0.001), Loss 3.951 (3.881), memo_loss: 3.951
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 28 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 25.855913162231445
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 980, 16272/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2559
Epoch: [28][508/508], Time 0.160 (0.168), Data 0.000 (0.001), Loss 2.958 (3.802), memo_loss: 2.958
learing rate be like [5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05, 5.600000000000001e-05] 160
Epoch 29 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.1419997215271
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 976, 16278/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2558
Epoch: [29][508/508], Time 0.164 (0.174), Data 0.000 (0.001), Loss 3.214 (3.756), memo_loss: 3.214
Test with epoch 29 model:
    rank1: 0.7644, rank5: 0.8528, rank10: 0.8811, rank20: 0.9053, mAP: 0.5868
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 30 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.387574434280396
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 978, 16288/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2562
Epoch: [30][509/509], Time 0.159 (0.169), Data 0.000 (0.001), Loss 5.743 (3.649), memo_loss: 5.743
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 31 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.27408242225647
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 979, 16304/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2566
Epoch: [31][509/509], Time 0.163 (0.175), Data 0.000 (0.001), Loss 4.661 (3.613), memo_loss: 4.661
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 32 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.861426830291748
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 979, 16299/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2566
Epoch: [32][509/509], Time 0.158 (0.170), Data 0.000 (0.001), Loss 3.246 (3.570), memo_loss: 3.246
Test with epoch 32 model:
    rank1: 0.7603, rank5: 0.8582, rank10: 0.8802, rank20: 0.9004, mAP: 0.5875
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 33 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.089322328567505
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 982, 16306/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2571
Epoch: [33][509/509], Time 0.161 (0.184), Data 0.000 (0.001), Loss 4.162 (3.533), memo_loss: 4.162
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 34 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.20290732383728
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 984, 16336/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2575
Epoch: [34][510/510], Time 0.190 (0.166), Data 0.000 (0.001), Loss 3.128 (3.594), memo_loss: 3.128
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 35 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 14.952570676803589
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 982, 16331/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2575
Epoch: [35][510/510], Time 0.165 (0.168), Data 0.000 (0.001), Loss 3.721 (3.538), memo_loss: 3.721
Test with epoch 35 model:
    rank1: 0.7567, rank5: 0.8586, rank10: 0.8829, rank20: 0.8990, mAP: 0.5862
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 36 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.559252977371216
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 982, 16343/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2578
Epoch: [36][510/510], Time 0.158 (0.169), Data 0.000 (0.001), Loss 3.042 (3.480), memo_loss: 3.042
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 37 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 14.98137903213501
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 979, 16361/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2576
Epoch: [37][511/511], Time 0.158 (0.170), Data 0.000 (0.001), Loss 3.223 (3.504), memo_loss: 3.223
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 38 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.04814052581787
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 984, 16366/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2581
Epoch: [38][511/511], Time 0.171 (0.165), Data 0.000 (0.001), Loss 2.742 (3.499), memo_loss: 2.742
Test with epoch 38 model:
    rank1: 0.7567, rank5: 0.8591, rank10: 0.8806, rank20: 0.9017, mAP: 0.5887
learing rate be like [2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05, 2.2400000000000006e-05] 160
Epoch 39 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.055193424224854
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 985, 16362/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2582
Epoch: [39][511/511], Time 0.176 (0.168), Data 0.000 (0.001), Loss 3.928 (3.488), memo_loss: 3.928
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 40 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.362121105194092
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 983, 16371/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2580
Epoch: [40][511/511], Time 0.160 (0.170), Data 0.000 (0.001), Loss 3.734 (3.440), memo_loss: 3.734
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 41 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.663573741912842
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 983, 16368/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2580
Epoch: [41][511/511], Time 0.151 (0.170), Data 0.000 (0.001), Loss 3.091 (3.420), memo_loss: 3.091
Test with epoch 41 model:
    rank1: 0.7585, rank5: 0.8541, rank10: 0.8811, rank20: 0.9035, mAP: 0.5837
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 42 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.913116693496704
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 982, 16371/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2582
Epoch: [42][511/511], Time 0.152 (0.162), Data 0.000 (0.001), Loss 2.598 (3.386), memo_loss: 2.598
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 43 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.127123594284058
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 983, 16364/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2583
Epoch: [43][511/511], Time 0.156 (0.158), Data 0.000 (0.001), Loss 3.306 (3.397), memo_loss: 3.306
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 44 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 14.998070478439331
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 984, 16376/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2584
Epoch: [44][511/511], Time 0.155 (0.158), Data 0.000 (0.001), Loss 4.678 (3.360), memo_loss: 4.678
Test with epoch 44 model:
    rank1: 0.7567, rank5: 0.8550, rank10: 0.8855, rank20: 0.9066, mAP: 0.5833
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 45 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.00402283668518
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 986, 16374/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2585
Epoch: [45][511/511], Time 0.152 (0.167), Data 0.000 (0.001), Loss 1.790 (3.351), memo_loss: 1.790
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 46 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.721718311309814
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 985, 16383/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2585
Epoch: [46][511/511], Time 0.153 (0.158), Data 0.000 (0.001), Loss 2.789 (3.333), memo_loss: 2.789
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 47 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 14.817666053771973
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 987, 16396/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2588
Epoch: [47][512/512], Time 0.151 (0.160), Data 0.000 (0.001), Loss 3.012 (3.350), memo_loss: 3.012
Test with epoch 47 model:
    rank1: 0.7576, rank5: 0.8586, rank10: 0.8860, rank20: 0.9048, mAP: 0.5807
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 48 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 14.84725046157837
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 989, 16403/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2593
Epoch: [48][512/512], Time 0.156 (0.159), Data 0.000 (0.001), Loss 4.054 (3.375), memo_loss: 4.054
learing rate be like [8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06, 8.960000000000002e-06] 160
Epoch 49 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.89249849319458
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 987, 16399/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2591
Epoch: [49][512/512], Time 0.167 (0.167), Data 0.000 (0.001), Loss 3.871 (3.337), memo_loss: 3.871
Final Model saved.
