log_dir=  Market_logs_new
args=  Namespace(arch='resnet50', base_lr=0.00035, batch_size=32, data_dir='/data0/ReIDData/', dropout=0.5, epochs=50, evaluate=False, features=2048, height=256, inv_alpha=0.2, inv_beta=0.07, load_ckpt='', logs_dir='Market_logs_new', milestones=[20, 40], momentum=0.9, pool_type='avgpool', print_freq=1, re=0.5, resume='', target='market1501', thresh=0.5, use_bnneck=True, weight_decay=0.0005, width=128, workers=8)
train image_dir= /data0/ReIDData/market1501/bounding_box_train
  length of all_img_prefix= 12936
  12936 samples in total.
  all cameras shape= (12936,), dtype= int64, unique values= [0 1 2 3 4 5]
train image_dir= /data0/ReIDData/market1501/bounding_box_train
  length of all_img_prefix= 12936
  12936 samples in total.
  all cameras shape= (12936,), dtype= int64, unique values= [0 1 2 3 4 5]
DA dataset loaded
  subset   | # ids | # images
  ---------------------------
  target train    | 'Unknown' |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
  target train(ori)| 'Unknown' |    12936
Epoch 0 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 22.314213752746582
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 210, 1464/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 328
Epoch: [0][45/45], Time 0.205 (0.237), Data 0.000 (0.018), Loss 11.344 (12.025), memo_loss: 11.344
Epoch 1 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 36.78853178024292
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 133, 1056/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 216
Epoch: [1][33/33], Time 0.142 (0.203), Data 0.000 (0.023), Loss 2.366 (2.029), memo_loss: 2.366
Epoch 2 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 31.69709539413452
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 254, 2209/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 464
Epoch: [2][69/69], Time 0.196 (0.192), Data 0.000 (0.011), Loss 2.609 (2.270), memo_loss: 2.609
Epoch 3 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 13.362526893615723
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 386, 3635/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 725
Epoch: [3][113/113], Time 0.181 (0.236), Data 0.000 (0.005), Loss 0.717 (2.244), memo_loss: 0.717
Epoch 4 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 43.87436628341675
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 500, 5112/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1031
Epoch: [4][159/159], Time 0.154 (0.179), Data 0.000 (0.005), Loss 1.949 (2.240), memo_loss: 1.949
Epoch 5 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 41.77545523643494
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 621, 6271/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1326
Epoch: [5][195/195], Time 0.188 (0.263), Data 0.000 (0.003), Loss 7.695 (8.265), memo_loss: 7.695
Epoch 6 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 63.48561882972717
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 728, 7901/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1800
Epoch: [6][246/246], Time 0.432 (0.266), Data 0.000 (0.003), Loss 9.204 (8.195), memo_loss: 9.204
Epoch 7 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 134.05280447006226
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 796, 9193/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2217
Epoch: [7][287/287], Time 0.175 (0.317), Data 0.000 (0.002), Loss 7.795 (7.721), memo_loss: 7.795
Epoch 8 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 15.822062969207764
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 823, 9998/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2438
Epoch: [8][312/312], Time 0.292 (0.247), Data 0.000 (0.002), Loss 5.328 (7.907), memo_loss: 5.328
Epoch 9 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 56.7221462726593
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 799, 10514/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2535
Epoch: [9][328/328], Time 0.270 (0.258), Data 0.000 (0.003), Loss 6.510 (7.805), memo_loss: 6.510
Test with epoch 9 model:
    rank1: 0.6740, rank5: 0.8216, rank10: 0.8717, rank20: 0.9124, mAP: 0.4113
Epoch 10 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 123.53772139549255
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 799, 10948/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2706
Epoch: [10][342/342], Time 0.386 (0.331), Data 0.000 (0.002), Loss 5.589 (7.841), memo_loss: 5.589
Epoch 11 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.409260988235474
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 768, 11291/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2749
Epoch: [11][352/352], Time 0.173 (0.311), Data 0.000 (0.002), Loss 8.214 (7.527), memo_loss: 8.214
Epoch 12 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 578.6751074790955
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 741, 11635/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2804
Epoch: [12][363/363], Time 0.262 (0.240), Data 0.000 (0.002), Loss 5.554 (7.289), memo_loss: 5.554
Epoch 13 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 66.13227725028992
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 759, 11876/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2910
Epoch: [13][371/371], Time 0.385 (0.283), Data 0.000 (0.002), Loss 7.509 (7.292), memo_loss: 7.509
Epoch 14 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 646.3135843276978
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 735, 11931/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2873
Epoch: [14][372/372], Time 0.378 (0.346), Data 0.000 (0.002), Loss 5.490 (7.184), memo_loss: 5.490
Epoch 15 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 535.2744207382202
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 776, 12095/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3023
Epoch: [15][377/377], Time 0.375 (0.310), Data 0.000 (0.002), Loss 9.535 (6.900), memo_loss: 9.535
Epoch 16 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 62.709171295166016
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 754, 12156/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2999
Epoch: [16][379/379], Time 0.221 (0.282), Data 0.000 (0.002), Loss 5.894 (6.713), memo_loss: 5.894
Epoch 17 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 560.36683177948
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 753, 12265/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3044
Epoch: [17][383/383], Time 0.239 (0.334), Data 0.000 (0.001), Loss 5.431 (6.619), memo_loss: 5.431
Epoch 18 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 842.7066071033478
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 766, 12347/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3089
Epoch: [18][385/385], Time 0.539 (0.288), Data 0.000 (0.002), Loss 8.205 (6.500), memo_loss: 8.205
Epoch 19 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 36.23801565170288
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 763, 12354/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3075
Epoch: [19][386/386], Time 0.205 (0.305), Data 0.000 (0.002), Loss 4.777 (6.424), memo_loss: 4.777
Test with epoch 19 model:
    rank1: 0.8480, rank5: 0.9371, rank10: 0.9575, rank20: 0.9736, mAP: 0.6591
Epoch 20 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 475.8932776451111
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 741, 12272/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3031
Epoch: [20][383/383], Time 0.286 (0.316), Data 0.000 (0.001), Loss 5.648 (5.806), memo_loss: 5.648
Epoch 21 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 411.72432804107666
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 752, 12500/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3099
Epoch: [21][390/390], Time 0.234 (0.275), Data 0.000 (0.001), Loss 7.288 (5.443), memo_loss: 7.288
Epoch 22 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 48.731420040130615
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 751, 12536/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3109
Epoch: [22][391/391], Time 0.226 (0.288), Data 0.000 (0.001), Loss 4.464 (5.127), memo_loss: 4.464
Epoch 23 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 53.136967420578
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 753, 12574/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3133
Epoch: [23][392/392], Time 1.884 (0.356), Data 0.000 (0.002), Loss 3.001 (5.200), memo_loss: 3.001
Epoch 24 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 275.73222303390503
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 750, 12592/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3145
Epoch: [24][393/393], Time 0.337 (0.324), Data 0.000 (0.001), Loss 5.292 (5.099), memo_loss: 5.292
Epoch 25 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 1288.7402744293213
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12626/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3140
Epoch: [25][394/394], Time 0.330 (0.300), Data 0.000 (0.001), Loss 5.480 (5.112), memo_loss: 5.480
Epoch 26 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 50.60107088088989
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 748, 12627/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3160
Epoch: [26][394/394], Time 0.374 (0.295), Data 0.000 (0.002), Loss 4.045 (5.083), memo_loss: 4.045
Epoch 27 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 752.2102336883545
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 747, 12635/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3157
Epoch: [27][394/394], Time 0.408 (0.335), Data 0.000 (0.001), Loss 2.671 (4.954), memo_loss: 2.671
Epoch 28 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 712.2348771095276
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 743, 12672/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3149
Epoch: [28][396/396], Time 0.184 (0.237), Data 0.000 (0.003), Loss 5.847 (4.935), memo_loss: 5.847
Epoch 29 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 13.218148231506348
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 742, 12681/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3150
Epoch: [29][396/396], Time 0.300 (0.315), Data 0.000 (0.001), Loss 4.206 (4.845), memo_loss: 4.206
Test with epoch 29 model:
    rank1: 0.9068, rank5: 0.9638, rank10: 0.9751, rank20: 0.9819, mAP: 0.7629
Epoch 30 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 607.9413356781006
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12724/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3164
Epoch: [30][397/397], Time 0.338 (0.361), Data 0.000 (0.001), Loss 5.140 (4.935), memo_loss: 5.140
Epoch 31 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 834.2363951206207
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 743, 12744/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3164
Epoch: [31][398/398], Time 0.295 (0.359), Data 0.000 (0.001), Loss 6.245 (4.821), memo_loss: 6.245
Epoch 32 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 41.14079689979553
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 739, 12737/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3157
Epoch: [32][398/398], Time 0.234 (0.297), Data 0.000 (0.001), Loss 5.680 (4.745), memo_loss: 5.680
Epoch 33 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 54.11903500556946
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 750, 12761/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3177
Epoch: [33][398/398], Time 1.303 (0.285), Data 0.000 (0.002), Loss 4.803 (4.811), memo_loss: 4.803
Epoch 34 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 25.875365495681763
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 743, 12765/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3168
Epoch: [34][398/398], Time 0.335 (0.298), Data 0.000 (0.002), Loss 2.865 (4.692), memo_loss: 2.865
Epoch 35 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 12.997725486755371
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 744, 12774/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3177
Epoch: [35][399/399], Time 0.248 (0.283), Data 0.000 (0.001), Loss 3.975 (4.647), memo_loss: 3.975
Epoch 36 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.36954140663147
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12786/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3186
Epoch: [36][399/399], Time 1.107 (0.260), Data 0.000 (0.002), Loss 6.051 (4.620), memo_loss: 6.051
Epoch 37 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 13.366149425506592
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 749, 12796/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3192
Epoch: [37][399/399], Time 0.459 (0.293), Data 0.000 (0.001), Loss 5.120 (4.656), memo_loss: 5.120
Epoch 38 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 35.1659152507782
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 748, 12778/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3185
Epoch: [38][399/399], Time 1.193 (0.304), Data 0.000 (0.001), Loss 4.100 (4.547), memo_loss: 4.100
Epoch 39 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 48.30451035499573
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12807/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3189
Epoch: [39][400/400], Time 0.407 (0.312), Data 0.000 (0.001), Loss 5.809 (4.555), memo_loss: 5.809
Test with epoch 39 model:
    rank1: 0.9038, rank5: 0.9605, rank10: 0.9715, rank20: 0.9792, mAP: 0.7608
Epoch 40 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 214.07299900054932
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12825/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3188
Epoch: [40][400/400], Time 0.219 (0.252), Data 0.000 (0.002), Loss 1.657 (4.491), memo_loss: 1.657
Epoch 41 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 938.1937780380249
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 747, 12831/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3189
Epoch: [41][400/400], Time 0.204 (0.271), Data 0.000 (0.002), Loss 4.714 (4.482), memo_loss: 4.714
Epoch 42 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 13.974172115325928
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 745, 12825/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3185
Epoch: [42][400/400], Time 0.274 (0.249), Data 0.000 (0.001), Loss 3.692 (4.374), memo_loss: 3.692
Epoch 43 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 13.324143409729004
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 749, 12838/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3193
Epoch: [43][401/401], Time 0.239 (0.263), Data 0.000 (0.001), Loss 3.690 (4.370), memo_loss: 3.690
Epoch 44 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 13.423571348190308
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12830/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3187
Epoch: [44][400/400], Time 0.210 (0.260), Data 0.000 (0.002), Loss 5.158 (4.380), memo_loss: 5.158
Epoch 45 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 577.3362143039703
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 747, 12838/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3191
Epoch: [45][401/401], Time 0.243 (0.313), Data 0.000 (0.003), Loss 5.327 (4.357), memo_loss: 5.327
Epoch 46 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 44.390538930892944
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 745, 12840/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3188
Epoch: [46][401/401], Time 0.234 (0.265), Data 0.000 (0.001), Loss 5.062 (4.353), memo_loss: 5.062
Epoch 47 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 36.49932861328125
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 745, 12837/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3187
Epoch: [47][401/401], Time 0.340 (0.265), Data 0.000 (0.001), Loss 2.999 (4.366), memo_loss: 2.999
Epoch 48 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 322.6441900730133
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 746, 12853/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3189
Epoch: [48][401/401], Time 0.370 (0.326), Data 0.000 (0.002), Loss 5.123 (4.262), memo_loss: 5.123
Epoch 49 image grouping:
Start Inference...
  features: shape= (12936, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 657.8720409870148
  distance matrix: shape= (12936, 12936)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 747, 12850/12936 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 3191
Epoch: [49][401/401], Time 0.174 (0.235), Data 0.000 (0.002), Loss 3.918 (4.258), memo_loss: 3.918
Test with epoch 49 model:
    rank1: 0.9002, rank5: 0.9620, rank10: 0.9715, rank20: 0.9798, mAP: 0.7621
Final Model saved.
