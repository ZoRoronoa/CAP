log_dir=  Duke_logs_new_lrcos
args=  Namespace(arch='resnet50', base_lr=0.00035, batch_size=32, data_dir='/data0/ReIDData/', dropout=0.5, epochs=50, evaluate=False, features=2048, height=256, inv_alpha=0.2, inv_beta=0.07, load_ckpt='', logs_dir='Duke_logs_new_lrcos', milestones=[20, 40], momentum=0.9, pool_type='avgpool', print_freq=1, re=0.5, resume='', target='dukemtmcreid', thresh=0.5, use_bnneck=True, weight_decay=0.0005, width=128, workers=8)
train image_dir= /data0/ReIDData/dukemtmcreid/bounding_box_train
  length of all_img_prefix= 16522
  16522 samples in total.
  all cameras shape= (16522,), dtype= int64, unique values= [0 1 2 3 4 5 6 7]
train image_dir= /data0/ReIDData/dukemtmcreid/bounding_box_train
  length of all_img_prefix= 16522
  16522 samples in total.
  all cameras shape= (16522,), dtype= int64, unique values= [0 1 2 3 4 5 6 7]
DA dataset loaded
  subset   | # ids | # images
  ---------------------------
  target train    | 'Unknown' |    16522
  query    |   702 |     2228
  gallery  |  1110 |    17661
  target train(ori)| 'Unknown' |    16522
Epoch 0 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 25.485822677612305
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 500, 5258/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 591
Epoch: [0][164/164], Time 0.121 (0.140), Data 0.000 (0.004), Loss 12.855 (12.889), memo_loss: 12.855
Epoch 1 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.414304733276367
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 788, 8974/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1207
Epoch: [1][280/280], Time 0.124 (0.129), Data 0.000 (0.002), Loss 5.025 (10.265), memo_loss: 5.025
Epoch 2 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 23.339150428771973
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 833, 8707/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1453
Epoch: [2][272/272], Time 0.123 (0.123), Data 0.000 (0.002), Loss 5.345 (4.511), memo_loss: 5.345
Epoch 3 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.395426511764526
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 897, 9531/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1581
Epoch: [3][297/297], Time 0.126 (0.128), Data 0.000 (0.002), Loss 2.765 (3.659), memo_loss: 2.765
Epoch 4 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.106197118759155
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 930, 9981/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1661
Epoch: [4][311/311], Time 0.110 (0.128), Data 0.000 (0.002), Loss 2.714 (3.745), memo_loss: 2.714
Epoch 5 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 21.55864119529724
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 978, 9936/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1577
Epoch: [5][310/310], Time 0.178 (0.181), Data 0.000 (0.002), Loss 9.292 (10.434), memo_loss: 9.292
Epoch 6 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.704843521118164
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 967, 10539/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1691
Epoch: [6][329/329], Time 0.166 (0.179), Data 0.000 (0.002), Loss 6.975 (8.579), memo_loss: 6.975
Epoch 7 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 22.46151304244995
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1029, 11296/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 1798
Epoch: [7][353/353], Time 0.189 (0.187), Data 0.000 (0.001), Loss 6.480 (7.977), memo_loss: 6.480
Epoch 8 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.73653769493103
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1061, 12358/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2016
Epoch: [8][386/386], Time 0.182 (0.180), Data 0.000 (0.001), Loss 7.414 (8.023), memo_loss: 7.414
Epoch 9 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.746283054351807
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1045, 12902/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2054
Epoch: [9][403/403], Time 0.170 (0.188), Data 0.000 (0.001), Loss 10.283 (8.360), memo_loss: 10.283
Test with epoch 9 model:
    rank1: 0.4874, rank5: 0.6324, rank10: 0.6943, rank20: 0.7419, mAP: 0.3105
Epoch 10 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.212164402008057
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1076, 13398/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2123
Epoch: [10][418/418], Time 0.207 (0.189), Data 0.000 (0.001), Loss 7.367 (8.167), memo_loss: 7.367
Epoch 11 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.512746572494507
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1037, 13736/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2139
Epoch: [11][429/429], Time 0.173 (0.184), Data 0.000 (0.001), Loss 5.846 (8.046), memo_loss: 5.846
Epoch 12 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.14600133895874
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1025, 13857/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2183
Epoch: [12][433/433], Time 0.230 (0.191), Data 0.000 (0.001), Loss 10.438 (8.006), memo_loss: 10.438
Epoch 13 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.305253982543945
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1054, 13975/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2226
Epoch: [13][436/436], Time 0.162 (0.177), Data 0.000 (0.001), Loss 7.999 (8.060), memo_loss: 7.999
Epoch 14 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.452835083007812
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1045, 14210/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2250
Epoch: [14][444/444], Time 0.163 (0.188), Data 0.000 (0.001), Loss 9.127 (7.612), memo_loss: 9.127
Epoch 15 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.133831024169922
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1043, 14137/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2221
Epoch: [15][441/441], Time 0.178 (0.181), Data 0.000 (0.001), Loss 7.646 (7.555), memo_loss: 7.646
Epoch 16 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 21.466830492019653
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1025, 14637/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2293
Epoch: [16][457/457], Time 0.161 (0.184), Data 0.000 (0.001), Loss 4.698 (7.474), memo_loss: 4.698
Epoch 17 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.053873777389526
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1023, 14497/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2294
Epoch: [17][453/453], Time 0.167 (0.180), Data 0.000 (0.001), Loss 5.599 (7.751), memo_loss: 5.599
Epoch 18 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 21.33091950416565
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 999, 14507/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2262
Epoch: [18][453/453], Time 0.252 (0.191), Data 0.000 (0.001), Loss 5.095 (7.334), memo_loss: 5.095
Epoch 19 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.320203065872192
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1001, 14683/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2320
Epoch: [19][458/458], Time 0.164 (0.180), Data 0.000 (0.001), Loss 7.145 (7.449), memo_loss: 7.145
Test with epoch 19 model:
    rank1: 0.6495, rank5: 0.7702, rank10: 0.8079, rank20: 0.8384, mAP: 0.4565
Epoch 20 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.310906648635864
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1022, 14872/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2324
Epoch: [20][464/464], Time 0.171 (0.176), Data 0.000 (0.001), Loss 8.101 (6.969), memo_loss: 8.101
Epoch 21 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.62799334526062
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1013, 14942/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2334
Epoch: [21][466/466], Time 0.175 (0.182), Data 0.000 (0.001), Loss 7.610 (7.179), memo_loss: 7.610
Epoch 22 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.147619485855103
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1032, 14966/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2341
Epoch: [22][467/467], Time 0.168 (0.180), Data 0.000 (0.001), Loss 7.892 (7.177), memo_loss: 7.892
Epoch 23 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.271595001220703
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1000, 15079/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2321
Epoch: [23][471/471], Time 0.164 (0.178), Data 0.000 (0.001), Loss 7.293 (7.097), memo_loss: 7.293
Epoch 24 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.349379539489746
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 986, 15073/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2330
Epoch: [24][471/471], Time 0.184 (0.178), Data 0.000 (0.002), Loss 7.162 (7.416), memo_loss: 7.162
Epoch 25 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.75336456298828
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 993, 15034/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2334
Epoch: [25][469/469], Time 0.184 (0.185), Data 0.000 (0.001), Loss 6.382 (7.082), memo_loss: 6.382
Epoch 26 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.330703020095825
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 973, 15070/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2320
Epoch: [26][470/470], Time 0.167 (0.181), Data 0.000 (0.001), Loss 5.451 (7.204), memo_loss: 5.451
Epoch 27 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 21.290433645248413
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1003, 15187/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2337
Epoch: [27][474/474], Time 0.171 (0.185), Data 0.000 (0.001), Loss 7.235 (6.999), memo_loss: 7.235
Epoch 28 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.746860027313232
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 986, 15128/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2336
Epoch: [28][472/472], Time 0.187 (0.179), Data 0.000 (0.001), Loss 6.294 (7.114), memo_loss: 6.294
Epoch 29 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 21.82370901107788
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 994, 15055/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2338
Epoch: [29][470/470], Time 0.190 (0.182), Data 0.000 (0.001), Loss 6.029 (6.964), memo_loss: 6.029
Test with epoch 29 model:
    rank1: 0.6840, rank5: 0.7922, rank10: 0.8312, rank20: 0.8618, mAP: 0.4818
Epoch 30 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 24.01750421524048
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 999, 15260/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2369
Epoch: [30][476/476], Time 0.179 (0.180), Data 0.000 (0.001), Loss 5.910 (6.861), memo_loss: 5.910
Epoch 31 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 22.34481906890869
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 997, 15136/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2361
Epoch: [31][473/473], Time 0.189 (0.183), Data 0.000 (0.001), Loss 6.450 (6.995), memo_loss: 6.450
Epoch 32 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.312686443328857
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1009, 15198/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2398
Epoch: [32][474/474], Time 0.190 (0.182), Data 0.000 (0.001), Loss 8.801 (6.943), memo_loss: 8.801
Epoch 33 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.846696376800537
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 1011, 15221/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2384
Epoch: [33][475/475], Time 0.168 (0.184), Data 0.000 (0.001), Loss 5.220 (6.479), memo_loss: 5.220
Epoch 34 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.602460145950317
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 995, 15266/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2364
Epoch: [34][477/477], Time 0.173 (0.180), Data 0.000 (0.001), Loss 5.852 (6.714), memo_loss: 5.852
Epoch 35 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.429975271224976
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 996, 15297/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2387
Epoch: [35][478/478], Time 0.174 (0.188), Data 0.000 (0.001), Loss 9.244 (6.750), memo_loss: 9.244
Epoch 36 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 20.681585550308228
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 996, 15309/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2376
Epoch: [36][478/478], Time 0.175 (0.186), Data 0.000 (0.002), Loss 5.334 (6.588), memo_loss: 5.334
Epoch 37 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.641513109207153
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 987, 15297/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2356
Epoch: [37][478/478], Time 0.170 (0.190), Data 0.000 (0.001), Loss 6.590 (6.704), memo_loss: 6.590
Epoch 38 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.202032566070557
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 993, 15413/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2409
Epoch: [38][481/481], Time 0.179 (0.195), Data 0.000 (0.001), Loss 5.576 (6.627), memo_loss: 5.576
Epoch 39 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.519487380981445
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 959, 15336/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2362
Epoch: [39][479/479], Time 0.164 (0.183), Data 0.000 (0.001), Loss 5.085 (6.638), memo_loss: 5.085
Test with epoch 39 model:
    rank1: 0.7069, rank5: 0.8182, rank10: 0.8541, rank20: 0.8770, mAP: 0.5064
Epoch 40 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.129165410995483
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 15339/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2380
Epoch: [40][479/479], Time 0.193 (0.186), Data 0.000 (0.001), Loss 4.375 (6.643), memo_loss: 4.375
Epoch 41 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.194133520126343
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 964, 15426/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2355
Epoch: [41][482/482], Time 0.189 (0.180), Data 0.000 (0.001), Loss 7.021 (6.548), memo_loss: 7.021
Epoch 42 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 19.53275489807129
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 972, 15456/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2383
Epoch: [42][483/483], Time 0.173 (0.187), Data 0.000 (0.001), Loss 6.985 (6.536), memo_loss: 6.985
Epoch 43 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.458916902542114
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 973, 15403/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2393
Epoch: [43][481/481], Time 0.164 (0.170), Data 0.000 (0.001), Loss 6.628 (6.636), memo_loss: 6.628
Epoch 44 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.590036392211914
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 966, 15368/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2388
Epoch: [44][480/480], Time 0.166 (0.175), Data 0.000 (0.001), Loss 5.643 (6.480), memo_loss: 5.643
Epoch 45 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.44169855117798
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 970, 15294/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2356
Epoch: [45][477/477], Time 0.177 (0.173), Data 0.000 (0.001), Loss 7.825 (6.496), memo_loss: 7.825
Epoch 46 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.726655960083008
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 979, 15341/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2399
Epoch: [46][479/479], Time 0.163 (0.172), Data 0.000 (0.001), Loss 7.930 (6.637), memo_loss: 7.930
Epoch 47 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 16.475688695907593
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 969, 15303/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2385
Epoch: [47][478/478], Time 0.164 (0.174), Data 0.000 (0.001), Loss 4.912 (6.640), memo_loss: 4.912
Epoch 48 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 18.984487533569336
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 981, 15423/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2397
Epoch: [48][481/481], Time 0.164 (0.175), Data 0.000 (0.001), Loss 5.494 (6.383), memo_loss: 5.494
Epoch 49 image grouping:
Start Inference...
  features: shape= (16522, 2048)
Computing jaccard distance...
Jaccard distance computing time cost: 17.129077196121216
  distance matrix: shape= (16522, 16522)
  perform image grouping...
  eps in cluster: 0.500
  updated_label: num_class= 974, 15378/16522 images are associated.
re-computing initialized intra-ID feature...
  sum(id_count_each_cam)= 2392
Epoch: [49][480/480], Time 0.163 (0.177), Data 0.000 (0.001), Loss 5.285 (6.421), memo_loss: 5.285
Test with epoch 49 model:
    rank1: 0.7047, rank5: 0.8106, rank10: 0.8474, rank20: 0.8739, mAP: 0.5064
Final Model saved.
